<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¾é†«é™¢è‡¨åºŠæŠ€èƒ½ä¸­å¿ƒOSCEå•å·æ»¿æ„åº¦æˆæ•ˆå„€è¡¨æ¿</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        /* Bauhaus Theme Variables */
        :root {
            --bauhaus-red: #D03328;
            --bauhaus-yellow: #EAB936;
            --bauhaus-blue: #1C4E8C;
            --bauhaus-white: #FCFBF9;
            --bauhaus-black: #1A1A1A;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bauhaus-white);
            color: var(--bauhaus-black);
            background-image: radial-gradient(var(--bauhaus-black) 1px, transparent 1px);
            background-size: 24px 24px;
        }

        /* Utility Classes */
        .bauhaus-border {
            border: 3px solid var(--bauhaus-black);
        }
        .bauhaus-shadow {
            box-shadow: 6px 6px 0px 0px var(--bauhaus-black);
        }
        .bauhaus-shadow-sm {
            box-shadow: 3px 3px 0px 0px var(--bauhaus-black);
        }
        .bauhaus-shadow-hover:hover {
            box-shadow: 8px 8px 0px 0px var(--bauhaus-black);
            transform: translate(-2px, -2px);
        }
        
        /* Sidebar Link Active State */
        .nav-link {
            cursor: pointer;
            text-decoration: none; /* For a tags */
        }
        .nav-link.active {
            background-color: var(--bauhaus-yellow);
            color: var(--bauhaus-black);
            border-color: var(--bauhaus-black);
            font-weight: 900;
            box-shadow: 4px 4px 0px 0px rgba(0,0,0,1);
            transform: translateY(-4px);
        }
        .nav-link:hover:not(.active) {
            background-color: #333;
            border-color: white;
            color: white;
        }

        /* View Switching Animations */
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #1A1A1A;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #777;
        }

        /* Tag Styles for Keywords */
        .keyword-tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: bold;
            border: 2px solid #1A1A1A;
            margin: 2px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .keyword-tag:hover {
            transform: scale(1.05);
        }
        .keyword-pos { background-color: #EAB936; color: black; }
        .keyword-neg { background-color: #D03328; color: white; }
    </style>
</head>
<body class="overflow-hidden h-screen w-screen">

    <!-- Modal (Hidden by default) -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/80 z-[60] hidden flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white border-[4px] border-black w-full max-w-md p-6 bauhaus-shadow relative transform transition-all scale-95 opacity-0" id="modal-content">
            <button onclick="closeModal()" class="absolute top-2 right-2 p-1 hover:bg-gray-100 border-2 border-transparent hover:border-black rounded-full">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            
            <div class="flex items-center gap-4 mb-4">
                <div class="bg-[#EAB936] p-3 border-[3px] border-black rounded-full">
                    <i data-lucide="info" class="w-6 h-6 text-black"></i>
                </div>
                <h3 class="text-xl font-black uppercase tracking-wide">System Notice</h3>
            </div>
            
            <p id="modal-message" class="text-lg font-bold mb-6">Message goes here...</p>
            
            <button onclick="closeModal()" class="w-full bg-[#1C4E8C] text-white font-bold py-3 border-[3px] border-black hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none shadow-[4px_4px_0px_0px_black] transition-all">
                UNDERSTOOD
            </button>
        </div>
    </div>

    <!-- Configuration Alert (Shows if URL is missing) -->
    <div id="config-alert" class="hidden fixed top-0 left-0 w-full bg-[#D03328] text-white p-2 text-center font-bold z-[70] border-b-4 border-black animate-pulse">
        âš ï¸ è«‹åœ¨ç¨‹å¼ç¢¼ä¸­è¨­å®šæ­£ç¢ºçš„ GAS_API_URL æ‰èƒ½è®€å–çœŸå¯¦æ•¸æ“šï¼
    </div>

    <!-- Main Flex Container -->
    <div class="flex h-screen flex-col">

        <!-- Header -->
        <header class="bg-[#1C4E8C] text-white border-b-[4px] border-black z-50 flex-shrink-0">
            <div class="w-full px-4 py-3 flex justify-between items-center relative overflow-hidden">
                <!-- Decorative Circle -->
                <div class="absolute top-[-20px] left-[-20px] w-20 h-20 bg-[#EAB936] rounded-full border-[3px] border-black z-0"></div>
                
                <div class="flex items-center gap-4 z-10 pl-8">
                    <div class="bg-white p-1.5 border-[3px] border-black shadow-[3px_3px_0px_0px_rgba(0,0,0,1)]">
                        <img src="https://www.chimei.org.tw/main/cmh_department/59012/mag/202111/images/logo.png" 
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2ZmZiIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5DTSBIb3NwaXRhbDwvdGV4dD48L3N2Zz4='"
                             alt="Logo" class="h-6 md:h-8 w-auto object-contain">
                    </div>
                    <div>
                        <h1 class="text-lg md:text-2xl font-black tracking-wide leading-none">è‡¨åºŠæŠ€èƒ½ä¸­å¿ƒ</h1>
                        <p class="text-[10px] md:text-xs font-bold text-[#EAB936] tracking-widest uppercase">OSCE Dashboard System</p>
                    </div>
                </div>

                <div class="flex items-center gap-3 z-10">
                    <div class="hidden md:flex items-center bg-black px-3 py-1 rounded-full border border-white">
                        <span id="system-status-dot" class="w-2 h-2 bg-yellow-500 rounded-full mr-2 animate-pulse"></span>
                        <span id="system-status-text" class="text-xs font-mono">Connecting...</span>
                    </div>
                    <button class="md:hidden p-2 bg-black border-2 border-white rounded-md" onclick="toggleSidebar()">
                        <i data-lucide="menu" class="w-5 h-5 text-white"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Body Container -->
        <div class="flex flex-1 overflow-hidden relative">
            
            <!-- Left Sidebar -->
            <aside id="sidebar" class="absolute md:relative w-64 bg-[#1A1A1A] text-white border-r-[4px] border-black flex flex-col h-full z-40 shadow-[4px_0_10px_rgba(0,0,0,0.5)] transform -translate-x-full md:translate-x-0 transition-transform duration-300">
                
                <!-- Filter Section -->
                <div id="filters-panel" class="p-5 border-b-2 border-gray-800 bg-[#222]">
                    <h3 class="text-[#EAB936] text-xs font-bold uppercase tracking-widest mb-3 flex items-center gap-2">
                        <i data-lucide="filter" class="w-3 h-3"></i> ç¯©é¸æ¢ä»¶ Filters
                    </h3>
                    
                    <div class="space-y-3">
                        <!-- Year Filter -->
                        <div>
                            <label class="text-xs text-gray-400 block mb-1">å¹´åº¦ Year</label>
                            <div class="relative">
                                <select id="global-year-filter" onchange="handleGlobalFilterChange()" class="w-full bg-black border-2 border-gray-600 text-white text-sm p-2 outline-none focus:border-[#EAB936] appearance-none rounded-none cursor-pointer">
                                    <option value="all">å…¨éƒ¨å¹´åº¦ All</option>
                                    <option value="2025">2025 å¹´åº¦</option>
                                    <option value="2024">2024 å¹´åº¦</option>
                                    <option value="2023">2023 å¹´åº¦</option>
                                </select>
                                <i data-lucide="chevron-down" class="absolute right-2 top-2.5 w-4 h-4 text-gray-400 pointer-events-none"></i>
                            </div>
                        </div>

                        <!-- Session/Date Filter -->
                        <div>
                            <label class="text-xs text-gray-400 block mb-1">å ´æ¬¡ Session</label>
                            <div class="relative">
                                <select id="global-date-filter" onchange="handleGlobalFilterChange()" class="w-full bg-black border-2 border-gray-600 text-white text-sm p-2 outline-none focus:border-[#EAB936] appearance-none rounded-none cursor-pointer">
                                    <option value="all">å…¨éƒ¨å ´æ¬¡ All</option>
                                    <!-- Populated by JS -->
                                </select>
                                <i data-lucide="chevron-down" class="absolute right-2 top-2.5 w-4 h-4 text-gray-400 pointer-events-none"></i>
                            </div>
                        </div>

                        <!-- Profession Filter (For SP Analysis) -->
                        <div id="filter-group-profession">
                            <label class="text-xs text-gray-400 block mb-1">è·é¡ Profession</label>
                            <div class="relative">
                                <select id="global-profession-filter" onchange="handleGlobalFilterChange()" class="w-full bg-black border-2 border-gray-600 text-white text-sm p-2 outline-none focus:border-[#EAB936] appearance-none rounded-none cursor-pointer">
                                    <option value="all">å…¨éƒ¨è·é¡ All</option>
                                    <option value="è¥¿é†«">è¥¿é†«</option>
                                    <option value="ç‰™é†«">ç‰™é†«</option>
                                    <option value="ä¸­é†«">ä¸­é†«</option>
                                    <option value="è­·ç†">è­·ç†</option>
                                    <option value="è—¥å¸«">è—¥å¸«</option>
                                </select>
                                <i data-lucide="chevron-down" class="absolute right-2 top-2.5 w-4 h-4 text-gray-400 pointer-events-none"></i>
                            </div>
                        </div>

                        <!-- Station Filter (For Feedback Analysis & SP Feedback Analysis) -->
                        <div id="filter-group-station" class="hidden">
                            <label class="text-xs text-gray-400 block mb-1">æ¸¬é©—ç«™ Station</label>
                            <div class="relative">
                                <select id="global-station-filter" onchange="handleGlobalFilterChange()" class="w-full bg-black border-2 border-gray-600 text-white text-sm p-2 outline-none focus:border-[#EAB936] appearance-none rounded-none cursor-pointer">
                                    <option value="all">å…¨éƒ¨ç«™é» All</option>
                                    <option value="1">ç¬¬ 1 ç«™</option><option value="2">ç¬¬ 2 ç«™</option><option value="3">ç¬¬ 3 ç«™</option>
                                    <option value="4">ç¬¬ 4 ç«™</option><option value="5">ç¬¬ 5 ç«™</option><option value="6">ç¬¬ 6 ç«™</option>
                                    <option value="7">ç¬¬ 7 ç«™</option><option value="8">ç¬¬ 8 ç«™</option><option value="9">ç¬¬ 9 ç«™</option>
                                    <option value="10">ç¬¬ 10 ç«™</option><option value="11">ç¬¬ 11 ç«™</option><option value="12">ç¬¬ 12 ç«™</option>
                                </select>
                                <i data-lucide="chevron-down" class="absolute right-2 top-2.5 w-4 h-4 text-gray-400 pointer-events-none"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Menu -->
                <nav class="p-4 space-y-8 flex-1 overflow-y-auto custom-scroll">
                    
                    <!-- Group 1: Dashboard -->
                    <div>
                        <h3 class="text-gray-500 text-xs font-bold uppercase tracking-widest mb-3 pl-2 border-l-2 border-[#1C4E8C]">
                            å„€è¡¨æ¿ Dashboard
                        </h3>
                        <div class="space-y-2">
                            <div onclick="switchView('dashboard')" id="nav-dashboard" class="nav-link active block p-3 border-2 transition-all">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                                    <span class="font-bold text-sm">ç¶œåˆåˆ†æç¸½è¦½</span>
                                </div>
                            </div>

                            <div onclick="switchView('examiner-sp-analysis')" id="nav-examiner-sp-analysis" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all opacity-70 hover:opacity-100">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="clipboard-check" class="w-4 h-4"></i>
                                    <span class="font-bold text-sm">è€ƒå®˜è©•æ ¸ SP åˆ†æ</span>
                                </div>
                            </div>

                            <div onclick="switchView('examiner-analysis')" id="nav-examiner-analysis" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all opacity-70 hover:opacity-100">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="bar-chart-2" class="w-4 h-4"></i>
                                    <span class="font-bold text-sm">è€ƒå®˜å›é¥‹åˆ†æ</span>
                                </div>
                            </div>

                            <div onclick="switchView('student-analysis')" id="nav-student-analysis" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all opacity-70 hover:opacity-100">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="graduation-cap" class="w-4 h-4"></i>
                                    <span class="font-bold text-sm">è€ƒç”Ÿå›é¥‹åˆ†æ</span>
                                </div>
                            </div>

                            <div onclick="switchView('sp-analysis')" id="nav-sp-analysis" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all opacity-70 hover:opacity-100">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="smile" class="w-4 h-4"></i>
                                    <span class="font-bold text-sm">æ¨™æº–åŒ–ç—…äººå›é¥‹åˆ†æ</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Group 2: Survey Entry -->
                    <div>
                        <h3 class="text-gray-500 text-xs font-bold uppercase tracking-widest mb-3 pl-2 border-l-2 border-[#D03328]">
                            å•å·å¡«å¯« Survey Entry
                        </h3>
                        <div class="space-y-2">
                            <a href="https://luyun1224.github.io/ChimeiOSCE/SP-Assessment-Examiner.html" target="_blank" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all group">
                                <div class="flex items-center justify-between">
                                    <span class="font-bold text-sm">è€ƒå®˜è©•æ ¸ SP</span>
                                    <i data-lucide="external-link" class="w-3 h-3 group-hover:text-[#EAB936] transition-colors"></i>
                                </div>
                            </a>
                            <a href="https://luyun1224.github.io/ChimeiOSCE/Examiner-Feedback.html" target="_blank" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all group">
                                <div class="flex items-center justify-between">
                                    <span class="font-bold text-sm">è€ƒå®˜å›é¥‹å•å·</span>
                                    <i data-lucide="external-link" class="w-3 h-3 group-hover:text-[#EAB936] transition-colors"></i>
                                </div>
                            </a>
                            <a href="https://luyun1224.github.io/ChimeiOSCE/Student-Feedback.html" target="_blank" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all group">
                                <div class="flex items-center justify-between">
                                    <span class="font-bold text-sm">è€ƒç”Ÿå›é¥‹å•å·</span>
                                    <i data-lucide="external-link" class="w-3 h-3 group-hover:text-[#EAB936] transition-colors"></i>
                                </div>
                            </a>
                            <!-- NEW LINK -->
                            <a href="https://luyun1224.github.io/ChimeiOSCE/SP-Feedback.html" target="_blank" class="nav-link block p-3 border-2 border-transparent hover:border-white transition-all group">
                                <div class="flex items-center justify-between">
                                    <span class="font-bold text-sm">æ¨™æº–åŒ–ç—…äººå›é¥‹å•å·</span>
                                    <i data-lucide="external-link" class="w-3 h-3 group-hover:text-[#EAB936] transition-colors"></i>
                                </div>
                            </a>
                        </div>
                    </div>

                </nav>

                <!-- Footer Info -->
                <div class="p-4 text-[10px] text-gray-500 text-center border-t-2 border-gray-800">
                    <p>v2.0.0 (All Fixed)</p>
                    <p>Designed for Chimei</p>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="flex-1 overflow-y-auto bg-[#FCFBF9] relative custom-scroll">
                
                <!-- Close sidebar overlay for mobile -->
                <div id="sidebar-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/50 z-30 hidden md:hidden"></div>

                <!-- VIEW 1: DASHBOARD (Landing) -->
                <div id="view-dashboard" class="p-4 md:p-8 animate-fade-in block">
                     <div class="flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8 border-b-2 border-black pb-4">
                        <div>
                            <h2 class="text-2xl md:text-3xl font-black flex flex-col md:flex-row md:items-center gap-3 leading-tight">
                                <div class="flex items-center gap-3">
                                    <span class="w-4 h-8 bg-[#D03328] border-2 border-black block flex-shrink-0"></span>
                                    <span>å¥‡ç¾é†«é™¢è‡¨åºŠæŠ€èƒ½ä¸­å¿ƒ</span>
                                </div>
                                <span>OSCEæˆæ•ˆå„€è¡¨æ¿</span>
                            </h2>
                            <p class="text-gray-500 font-bold mt-1 ml-7">OSCE Effectiveness & Insight Dashboard</p>
                        </div>
                        <div class="text-right">
                             <button onclick="fetchAllData()" class="bg-black text-white px-4 py-2 text-xs font-bold hover:bg-[#EAB936] hover:text-black transition-colors border border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)]">
                                <i data-lucide="refresh-cw" class="w-3 h-3 inline mr-1"></i> REFRESH ALL DATA
                            </button>
                        </div>
                    </div>

                    <div class="bg-white border-[3px] border-black p-8 bauhaus-shadow flex flex-col items-center justify-center text-gray-400 min-h-[300px]">
                        <div class="bg-[#EAB936] p-4 rounded-full border-[3px] border-black mb-4">
                            <i data-lucide="bar-chart-2" class="w-12 h-12 text-black"></i>
                        </div>
                        <h3 class="text-2xl font-black text-black mb-2 text-center">æ­¡è¿ä½¿ç”¨æˆæ•ˆåˆ†æç³»çµ±</h3>
                        <p class="text-sm max-w-md text-center mb-6 text-gray-600">æœ¬ç³»çµ±æä¾›æ•¸æ“šè¦–è¦ºåŒ–èˆ‡è¡Œå‹•å»ºè­°ã€‚è«‹å¾å·¦å´é¸å–®é¸æ“‡ä¸åŒçš„åˆ†æè¦–åœ–ä»¥æŸ¥çœ‹è©³ç´°é›·é”åœ–èˆ‡æ”¹å–„å»ºè­°ã€‚</p>
                        <div class="flex flex-wrap justify-center gap-4">
                            <button onclick="switchView('examiner-sp-analysis')" class="bg-[#1C4E8C] text-white px-6 py-3 font-bold border-[3px] border-black shadow-[4px_4px_0px_0px_black] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[1px_1px_0px_0px_black] transition-all">
                                è€ƒå®˜è©•æ ¸ SP åˆ†æ
                            </button>
                            <button onclick="switchView('examiner-analysis')" class="bg-[#D03328] text-white px-6 py-3 font-bold border-[3px] border-black shadow-[4px_4px_0px_0px_black] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[1px_1px_0px_0px_black] transition-all">
                                è€ƒå®˜å›é¥‹åˆ†æ
                            </button>
                            <button onclick="switchView('student-analysis')" class="bg-[#EAB936] text-black px-6 py-3 font-bold border-[3px] border-black shadow-[4px_4px_0px_0px_black] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[1px_1px_0px_0px_black] transition-all">
                                è€ƒç”Ÿå›é¥‹åˆ†æ
                            </button>
                            <button onclick="switchView('sp-analysis')" class="bg-black text-white px-6 py-3 font-bold border-[3px] border-white shadow-[4px_4px_0px_0px_gray] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[1px_1px_0px_0px_gray] transition-all">
                                SP å›é¥‹åˆ†æ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- VIEW 2: EXAMINER SP ANALYSIS (Main Analysis) -->
                <div id="view-examiner-sp-analysis" class="p-4 md:p-8 animate-fade-in hidden">
                    <!-- Title -->
                    <div class="flex justify-between items-end border-b-2 border-black pb-4 mb-8">
                        <div>
                            <h2 class="text-3xl font-black flex items-center gap-3">
                                <span class="w-4 h-8 bg-[#1C4E8C] border-2 border-black block"></span>
                                è€ƒå®˜è©•æ ¸ SP åˆ†æ
                            </h2>
                            <p class="text-gray-500 font-bold mt-1 ml-7">Examiner Assessment: 8 Dimensions & Insights</p>
                        </div>
                        <div class="text-right hidden md:block">
                             <div class="text-xs text-gray-400 font-bold">DATA SOURCE</div>
                             <div class="font-mono text-sm">Live Google Sheet</div>
                        </div>
                    </div>
                    
                    <!-- Content unchanged for brevity, but still present -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative overflow-hidden group">
                            <div class="absolute right-[-10px] top-[-10px] w-20 h-20 bg-gray-100 rounded-full z-0 group-hover:bg-[#EAB936] transition-colors"></div>
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">ç¸½å•å·æ¨£æœ¬æ•¸</p>
                                <h3 class="text-4xl font-black" id="stat-total-records">--</h3>
                                <div class="w-8 h-1 bg-black mt-2"></div>
                            </div>
                        </div>
                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-5 bauhaus-shadow relative overflow-hidden">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-400 uppercase tracking-widest mb-1">å¹³å‡ç¸½é«”å¾—åˆ†</p>
                                <h3 class="text-4xl font-black text-[#EAB936]" id="stat-avg-score">--</h3>
                                <p class="text-[10px] text-gray-500 mt-1">(åå‘é¡Œ Q2, Q3 å·²æ ¡æ­£)</p>
                            </div>
                        </div>
                        <div class="bg-[#D03328] text-white border-[3px] border-black p-5 bauhaus-shadow relative overflow-hidden">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-white/80 uppercase tracking-widest mb-1">Q1 å¯é ä¸€è‡´æ€§</p>
                                <h3 class="text-4xl font-black text-white" id="stat-q1-score">--</h3>
                                <p class="text-[10px] text-white/60 mt-1">Core Competency</p>
                            </div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative overflow-hidden">
                             <div class="absolute right-[-10px] top-[-10px] w-20 h-20 bg-blue-50 rounded-full z-0"></div>
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">Q8 å°ˆæ¥­æ…‹åº¦</p>
                                <h3 class="text-4xl font-black text-[#1C4E8C]" id="stat-q8-score">--</h3>
                                <p class="text-[10px] text-gray-400 mt-1">Higher is Better (Scale: 1-5)</p>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold border-l-4 border-[#1C4E8C] pl-3">å…«å¤§é¢å‘èƒ½åŠ›åˆ†æ</h3>
                            </div>
                            <div class="flex-1 min-h-[320px] relative"><canvas id="chart-radar"></canvas></div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold border-l-4 border-[#EAB936] pl-3">å„è·é¡è©•åˆ†å·®ç•°</h3>
                            </div>
                            <div class="flex-1 min-h-[320px] relative"><canvas id="chart-profession"></canvas></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                        <div class="lg:col-span-2 bg-white border-[3px] border-black p-6 bauhaus-shadow">
                            <div class="flex items-center gap-2 mb-6 border-b-2 border-gray-100 pb-2">
                                <div class="bg-black text-white p-1.5"><i data-lucide="message-square" class="w-4 h-4"></i></div>
                                <h3 class="text-xl font-bold">è€ƒå®˜è³ªæ€§å›é¥‹èˆ‡é—œéµå­—</h3>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="text-sm font-bold text-gray-500 uppercase mb-2">é«˜é »é—œéµå­—</h4>
                                    <div id="keyword-cloud" class="flex flex-wrap gap-2 min-h-[100px] content-start"></div>
                                </div>
                                <div class="border-l-2 border-gray-100 pl-4">
                                    <h4 class="text-sm font-bold text-gray-500 uppercase mb-2">æœ€æ–°è©•èª</h4>
                                    <div id="recent-comments-list" class="space-y-3 max-h-[200px] overflow-y-auto custom-scroll pr-2"></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-6 bauhaus-shadow relative overflow-hidden">
                            <div class="relative z-10 flex flex-col h-full">
                                <div class="flex items-center gap-2 mb-4 border-b border-gray-700 pb-2">
                                    <div class="bg-[#EAB936] text-black p-1.5"><i data-lucide="zap" class="w-4 h-4"></i></div>
                                    <h3 class="text-xl font-bold">å“è³ªæ”¹å–„è¡Œå‹•</h3>
                                </div>
                                <div class="flex-1">
                                    <div class="mb-4">
                                        <h4 class="text-xs font-bold text-[#EAB936] uppercase tracking-wider mb-1">å„ªå…ˆæ”¹å–„é¢å‘</h4>
                                        <div id="action-priority" class="text-lg font-bold">--</div>
                                    </div>
                                    <div class="mb-4">
                                        <h4 class="text-xs font-bold text-[#D03328] uppercase tracking-wider mb-2">éœ€é—œæ³¨ SP åå–®</h4>
                                        <ul id="sp-watchlist" class="text-sm space-y-2 bg-[#222] p-2 rounded border border-gray-700"></ul>
                                    </div>
                                    <div class="mb-2">
                                        <h4 class="text-xs font-bold text-[#EAB936] uppercase tracking-wider mb-1">AI å»ºè­°è¡Œå‹•</h4>
                                        <p id="action-suggestion" class="text-xs text-gray-300 leading-relaxed">...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold border-l-4 border-gray-400 pl-3">è©³ç´°æ•¸æ“šåˆ—è¡¨</h3>
                            <button onclick="exportCSV()" class="text-xs font-bold underline hover:text-[#1C4E8C]">åŒ¯å‡º CSV</button>
                        </div>
                        <div class="overflow-x-auto max-h-[400px] custom-scroll">
                            <table class="w-full text-left text-sm border-collapse">
                                <thead class="bg-black text-white sticky top-0">
                                    <tr>
                                        <th class="p-3 whitespace-nowrap">æ—¥æœŸ</th>
                                        <th class="p-3 whitespace-nowrap">SPå§“å</th>
                                        <th class="p-3 whitespace-nowrap">è€ƒå®˜</th>
                                        <th class="p-3 whitespace-nowrap">ç«™è™Ÿ</th>
                                        <th class="p-3 whitespace-nowrap">è·é¡</th>
                                        <th class="p-3">Q1</th><th class="p-3 text-red-300">Q2(å)</th><th class="p-3 text-red-300">Q3(å)</th>
                                        <th class="p-3">Q4</th><th class="p-3">Q5</th><th class="p-3">Q6</th><th class="p-3">Q7</th><th class="p-3">Q8</th>
                                        <th class="p-3 min-w-[200px]">æ–‡å­—è©•èª</th>
                                    </tr>
                                </thead>
                                <tbody id="table-comments-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VIEW 3: EXAMINER FEEDBACK ANALYSIS -->
                <div id="view-examiner-analysis" class="p-4 md:p-8 animate-fade-in hidden">
                    <div class="flex flex-col xl:flex-row justify-between items-end border-b-2 border-black pb-4 mb-6 gap-4">
                        <div>
                             <h2 class="text-3xl font-black flex items-center gap-3">
                                <span class="w-4 h-8 bg-[#EAB936] border-2 border-black block"></span>
                                è€ƒå®˜å›é¥‹åˆ†æ
                            </h2>
                            <p class="text-gray-500 font-bold mt-1 ml-7">Examiner Feedback Dashboard</p>
                        </div>
                        <div>
                             <button onclick="fetchFeedbackData()" class="bg-black text-white px-3 py-1.5 text-xs font-bold hover:bg-[#EAB936] hover:text-black transition-colors border border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)]">
                                <i data-lucide="refresh-cw" class="w-3 h-3 inline mr-1"></i> RELOAD
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">å›é¥‹æ¨£æœ¬æ•¸</p>
                            <h3 class="text-4xl font-black" id="fb-stat-count">--</h3>
                            <div class="w-8 h-1 bg-[#1C4E8C] mt-2"></div>
                        </div>
                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <p class="text-xs font-black text-gray-400 uppercase tracking-widest mb-1">å¹³å‡æ»¿æ„åº¦ (Q1-Q8)</p>
                            <h3 class="text-4xl font-black text-[#EAB936]" id="fb-stat-avg">--</h3>
                        </div>
                        <div class="bg-[#D03328] text-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <p class="text-xs font-black text-white/80 uppercase tracking-widest mb-1">éœ€é—œæ³¨é¢å‘ (Lowest)</p>
                            <h3 class="text-2xl font-black text-white mt-1" id="fb-stat-low">--</h3>
                            <p class="text-[10px] text-white/60 mt-1" id="fb-stat-low-score">Score: --</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold border-l-4 border-[#1C4E8C] pl-3">å…«å¤§é¢å‘æ»¿æ„åº¦</h3>
                            </div>
                            <div class="flex-1 min-h-[300px] relative"><canvas id="fb-chart-questions"></canvas></div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold border-l-4 border-[#EAB936] pl-3">å„æ¸¬é©—ç«™æ»¿æ„åº¦</h3>
                            </div>
                            <div class="flex-1 min-h-[300px] relative"><canvas id="fb-chart-stations"></canvas></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                        <div class="lg:col-span-2 bg-white border-[3px] border-black p-6 bauhaus-shadow">
                            <div class="flex items-center gap-2 mb-6 border-b-2 border-gray-100 pb-2">
                                <h3 class="text-xl font-bold">æ–‡å­—å›é¥‹é—œéµå­—èˆ‡åˆ—è¡¨</h3>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><div id="fb-keyword-cloud" class="flex flex-wrap gap-2 min-h-[100px] content-start"></div></div>
                                <div class="border-l-2 border-gray-100 pl-4"><div id="fb-comments-list" class="space-y-3 max-h-[200px] overflow-y-auto custom-scroll pr-2"></div></div>
                            </div>
                        </div>
                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-6 bauhaus-shadow relative overflow-hidden">
                            <div class="relative z-10 flex flex-col h-full">
                                <div class="flex items-center gap-2 mb-4 border-b border-gray-700 pb-2">
                                    <h3 class="text-xl font-bold">å“è³ªæ”¹å–„è¡Œå‹•</h3>
                                </div>
                                <div class="flex-1">
                                    <div class="mb-4">
                                        <h4 class="text-xs font-bold text-[#EAB936] uppercase tracking-wider mb-1">å„ªå…ˆæ”¹å–„é¢å‘</h4>
                                        <div id="fb-action-priority" class="text-lg font-bold">--</div>
                                    </div>
                                    <div class="mb-2">
                                        <h4 class="text-xs font-bold text-[#EAB936] uppercase tracking-wider mb-1">AI å»ºè­°è¡Œå‹•</h4>
                                        <p id="fb-action-suggestion" class="text-xs text-gray-300 leading-relaxed">...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold border-l-4 border-gray-400 pl-3">è©³ç´°æ•¸æ“šåˆ—è¡¨</h3>
                            <button onclick="exportFeedbackCSV()" class="text-xs font-bold underline hover:text-[#1C4E8C]">åŒ¯å‡º CSV</button>
                        </div>
                        <div class="overflow-x-auto max-h-[500px] custom-scroll">
                            <table class="w-full text-left text-sm border-collapse">
                                <thead class="bg-black text-white sticky top-0 z-10">
                                    <tr>
                                        <th class="p-3 whitespace-nowrap">æ—¥æœŸ</th><th class="p-3 whitespace-nowrap">è€ƒå®˜</th><th class="p-3 text-center">ç«™è™Ÿ</th>
                                        <th class="p-3 text-center">Q1</th><th class="p-3 text-center">Q2</th><th class="p-3 text-center">Q3</th><th class="p-3 text-center">Q4</th>
                                        <th class="p-3 text-center">Q5</th><th class="p-3 text-center">Q6</th><th class="p-3 text-center">Q7</th><th class="p-3 text-center">Q8</th>
                                        <th class="p-3 min-w-[200px]">è€ƒé¡Œå»ºè­°</th><th class="p-3 min-w-[200px]">æ•´é«”å»ºè­°</th>
                                    </tr>
                                </thead>
                                <tbody id="fb-data-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VIEW 4: STUDENT FEEDBACK ANALYSIS -->
                <div id="view-student-analysis" class="p-4 md:p-8 animate-fade-in hidden">
                    <div class="flex flex-col md:flex-row justify-between items-end border-b-2 border-black pb-4 mb-8 gap-4">
                        <div>
                            <h2 class="text-3xl font-black flex items-center gap-3">
                                <span class="w-4 h-8 bg-[#EAB936] border-2 border-black block"></span>
                                è€ƒç”Ÿå›é¥‹åˆ†æ
                            </h2>
                            <p class="text-gray-500 font-bold mt-1 ml-7">Student Feedback Analytics</p>
                        </div>
                        <div>
                             <button onclick="fetchStudentData()" class="bg-black text-white px-3 py-1.5 text-xs font-bold hover:bg-[#EAB936] hover:text-black transition-colors border border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)]">
                                <i data-lucide="refresh-cw" class="w-3 h-3 inline mr-1"></i> RELOAD
                            </button>
                        </div>
                    </div>

                    <!-- Top Stats Row -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative overflow-hidden">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">ç¸½å•å·ä»½æ•¸</p>
                                <h3 class="text-4xl font-black" id="stu-stat-count">--</h3>
                                <div class="w-8 h-1 bg-black mt-2"></div>
                            </div>
                        </div>
                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-400 uppercase tracking-widest mb-1">å¹³å‡æ»¿æ„åº¦ (Q1-Q9)</p>
                                <h3 class="text-4xl font-black text-[#EAB936]" id="stu-stat-avg">--</h3>
                                <p class="text-[10px] text-gray-500 mt-1">æ»¿åˆ† 5.0</p>
                            </div>
                        </div>
                        <div class="bg-[#D03328] text-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-white/80 uppercase tracking-widest mb-1">SP æ¼”å‡ºçœŸå¯¦åº¦ (Q6)</p>
                                <h3 class="text-4xl font-black text-white" id="stu-stat-sp-score">--</h3>
                                <p class="text-[10px] text-white/60 mt-1">Target: > 4.5</p>
                            </div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">é›£åº¦æ„ŸçŸ¥çœ¾æ•¸</p>
                                <h3 class="text-2xl font-black text-[#1C4E8C] mt-2 truncate" id="stu-stat-difficulty-mode">--</h3>
                                <p class="text-[10px] text-gray-400 mt-1">Q10 çµæœåˆ†ä½ˆ</p>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                        <div class="lg:col-span-2 bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6 border-b-2 border-gray-100 pb-2">
                                <h3 class="text-xl font-bold border-l-4 border-[#1C4E8C] pl-3">å„é¢å‘æ»¿æ„åº¦åˆ†æ (Q1-Q9)</h3>
                            </div>
                            <div class="flex-1 min-h-[350px] relative">
                                <canvas id="stu-chart-radar"></canvas>
                            </div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6 border-b-2 border-gray-100 pb-2">
                                <h3 class="text-xl font-bold border-l-4 border-[#EAB936] pl-3">é›£åº¦åˆ†ä½ˆ (Q10)</h3>
                            </div>
                            <div class="flex-1 min-h-[300px] relative flex items-center justify-center">
                                <canvas id="stu-chart-difficulty"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Insights Row (Modified for Split Comments) -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col h-full">
                            <div class="flex items-center gap-2 mb-6 border-b-2 border-gray-100 pb-2">
                                <div class="bg-black text-white p-1.5"><i data-lucide="message-square" class="w-4 h-4"></i></div>
                                <h3 class="text-xl font-bold">è€ƒé¡Œèˆ‡æ•´é«”å»ºè­°</h3>
                            </div>
                            
                            <div class="mb-6">
                                <h4 class="text-sm font-bold text-[#1C4E8C] uppercase mb-2">ğŸ”¥ é«˜é »é—œéµå­—</h4>
                                <div id="stu-keyword-cloud" class="flex flex-wrap gap-2 min-h-[60px] content-start p-3 bg-gray-50 border border-gray-200"></div>
                            </div>

                            <!-- Split Comments Area -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 flex-1 overflow-hidden">
                                <div class="flex flex-col h-full">
                                    <h4 class="text-sm font-bold text-[#1C4E8C] uppercase mb-2 flex items-center gap-1">
                                        <i data-lucide="file-question" class="w-3 h-3"></i> Q11 è€ƒé¡Œå»ºè­°
                                    </h4>
                                    <div id="stu-comments-exam" class="space-y-2 flex-1 overflow-y-auto custom-scroll pr-2 bg-blue-50/50 p-2 border border-blue-100 min-h-[200px]"></div>
                                </div>
                                <div class="flex flex-col h-full">
                                    <h4 class="text-sm font-bold text-[#D03328] uppercase mb-2 flex items-center gap-1">
                                        <i data-lucide="messages-square" class="w-3 h-3"></i> Q12 æ•´é«”å»ºè­°
                                    </h4>
                                    <div id="stu-comments-general" class="space-y-2 flex-1 overflow-y-auto custom-scroll pr-2 bg-red-50/50 p-2 border border-red-100 min-h-[200px]"></div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-6 bauhaus-shadow relative overflow-hidden flex flex-col">
                            <div class="relative z-10">
                                <div class="flex items-center gap-2 mb-6 border-b border-gray-700 pb-2">
                                    <div class="bg-[#EAB936] text-black p-1.5"><i data-lucide="zap" class="w-4 h-4"></i></div>
                                    <h3 class="text-xl font-bold">å“è³ªæ”¹å–„å»ºè­° (AI Insights)</h3>
                                </div>
                                <div class="space-y-6">
                                    <div class="bg-[#222] p-4 border border-gray-700 rounded">
                                        <h4 class="text-xs font-bold text-[#D03328] uppercase tracking-wider mb-2">ğŸ”» æœ€ä½åˆ†é¢å‘</h4>
                                        <div class="flex items-end gap-3">
                                            <span id="stu-insight-lowest-dim" class="text-xl font-black text-white">--</span>
                                            <span id="stu-insight-lowest-score" class="text-sm font-bold text-gray-400 mb-1">Score: --</span>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="text-xs font-bold text-[#EAB936] uppercase tracking-wider mb-2">âš¡ å»ºè­°è¡Œå‹•æ–¹æ¡ˆ</h4>
                                        <p id="stu-insight-action" class="text-sm text-gray-300 leading-relaxed bg-black/50 p-4 border-l-4 border-[#EAB936]">
                                            ç­‰å¾…è³‡æ–™åˆ†æ...
                                        </p>
                                    </div>
                                    <div>
                                        <h4 class="text-xs font-bold text-blue-400 uppercase tracking-wider mb-2">ğŸ“Š é›£åº¦æ„ŸçŸ¥è§£è®€</h4>
                                        <p id="stu-insight-difficulty" class="text-sm text-gray-300 leading-relaxed">
                                            ç­‰å¾…è³‡æ–™åˆ†æ...
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Data Table -->
                    <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow mb-8">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold border-l-4 border-black pl-3">åŸå§‹æ•¸æ“šåˆ—è¡¨</h3>
                            <button onclick="exportStudentCSV()" class="text-xs font-bold underline hover:text-[#1C4E8C] flex items-center gap-1">
                                <i data-lucide="download" class="w-3 h-3"></i> åŒ¯å‡º CSV
                            </button>
                        </div>
                        <div class="overflow-x-auto max-h-[500px] custom-scroll">
                            <table class="w-full text-left text-sm border-collapse">
                                <thead class="bg-black text-white sticky top-0 z-10">
                                    <tr>
                                        <th class="p-3 whitespace-nowrap">æ™‚é–“</th><th class="p-3 whitespace-nowrap">å§“å</th><th class="p-3 whitespace-nowrap">æ—¥æœŸ</th>
                                        <th class="p-3 text-center">Q1</th><th class="p-3 text-center">Q2</th><th class="p-3 text-center">Q3</th>
                                        <th class="p-3 text-center">Q4</th><th class="p-3 text-center">Q5</th><th class="p-3 text-center">Q6</th>
                                        <th class="p-3 text-center">Q7</th><th class="p-3 text-center">Q8</th><th class="p-3 text-center">Q9</th>
                                        <th class="p-3 whitespace-nowrap">Q10</th><th class="p-3 min-w-[200px]">Q11</th><th class="p-3 min-w-[200px]">Q12</th>
                                    </tr>
                                </thead>
                                <tbody id="stu-data-table-body">
                                    <tr><td colspan="15" class="p-8 text-center text-gray-400">Loading data...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VIEW 5: SP FEEDBACK ANALYSIS (NEW INTEGRATION) -->
                <div id="view-sp-analysis" class="p-4 md:p-8 animate-fade-in hidden">
                    <div class="flex flex-col md:flex-row justify-between items-end border-b-2 border-black pb-4 mb-8 gap-4">
                        <div>
                            <h2 class="text-3xl font-black flex items-center gap-3">
                                <span class="w-4 h-8 bg-black border-2 border-white block"></span>
                                æ¨™æº–åŒ–ç—…äºº(SP) å›é¥‹åˆ†æ
                            </h2>
                            <p class="text-gray-500 font-bold mt-1 ml-7">SP Feedback & Workload Analysis</p>
                        </div>
                        <div>
                             <button onclick="fetchSpFeedbackData()" class="bg-black text-white px-3 py-1.5 text-xs font-bold hover:bg-[#EAB936] hover:text-black transition-colors border border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)]">
                                <i data-lucide="refresh-cw" class="w-3 h-3 inline mr-1"></i> RELOAD DATA
                            </button>
                        </div>
                    </div>

                    <!-- Top Stats Row -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative overflow-hidden">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">SP å›é¥‹ä»½æ•¸</p>
                                <h3 class="text-4xl font-black" id="sp-stat-count">--</h3>
                                <div class="w-8 h-1 bg-black mt-2"></div>
                            </div>
                        </div>
                        <div class="bg-[#1A1A1A] text-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-400 uppercase tracking-widest mb-1">å¹³å‡æ»¿æ„åº¦ (Q1-Q6)</p>
                                <h3 class="text-4xl font-black text-[#EAB936]" id="sp-stat-avg">--</h3>
                                <p class="text-[10px] text-gray-500 mt-1">æ»¿åˆ† 5.0</p>
                            </div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-gray-500 uppercase tracking-widest mb-1">å¹³å‡å¯¦éš›æ¼”å‡ºæ¬¡æ•¸</p>
                                <h3 class="text-4xl font-black text-[#1C4E8C]" id="sp-stat-avg-plays">--</h3>
                                <p class="text-[10px] text-gray-400 mt-1">Q4-1</p>
                            </div>
                        </div>
                        <div class="bg-[#D03328] text-white border-[3px] border-black p-5 bauhaus-shadow relative">
                            <div class="relative z-10">
                                <p class="text-xs font-black text-white/80 uppercase tracking-widest mb-1">è² æ“”æŒ‡æ•¸ (å¯¦éš›/å»ºè­°)</p>
                                <h3 class="text-4xl font-black text-white" id="sp-stat-workload">--</h3>
                                <p class="text-[10px] text-white/60 mt-1">> 100% è¡¨ç¤ºè¶…è¼‰</p>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                        <div class="lg:col-span-2 bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6 border-b-2 border-gray-100 pb-2">
                                <h3 class="text-xl font-bold border-l-4 border-black pl-3">å„é¢å‘æ»¿æ„åº¦åˆ†æ (Q1-Q6)</h3>
                            </div>
                            <div class="flex-1 min-h-[350px] relative">
                                <canvas id="sp-chart-radar"></canvas>
                            </div>
                        </div>
                        <div class="bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex justify-between items-center mb-6 border-b-2 border-gray-100 pb-2">
                                <h3 class="text-xl font-bold border-l-4 border-[#EAB936] pl-3">æ¼”å‡ºæ¬¡æ•¸åˆ†æ (Actual vs Ideal)</h3>
                            </div>
                            <div class="flex-1 min-h-[300px] relative flex items-center justify-center">
                                <canvas id="sp-chart-workload"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Comments & Table -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                        <div class="lg:col-span-1 bg-white border-[3px] border-black p-6 bauhaus-shadow flex flex-col">
                            <div class="flex items-center gap-2 mb-6 border-b-2 border-gray-100 pb-2">
                                <div class="bg-black text-white p-1.5"><i data-lucide="message-square" class="w-4 h-4"></i></div>
                                <h3 class="text-xl font-bold">SP å»ºè­°äº‹é … (Q7)</h3>
                            </div>
                            <div class="mb-4">
                                <h4 class="text-xs font-bold text-[#1C4E8C] uppercase mb-2">é—œéµå­—</h4>
                                <div id="sp-keyword-cloud" class="flex flex-wrap gap-2 min-h-[50px] content-start p-2 bg-gray-50 border border-gray-200"></div>
                            </div>
                            <div id="sp-comments-list" class="space-y-2 flex-1 overflow-y-auto custom-scroll pr-2 bg-gray-50 p-2 border border-gray-100 min-h-[200px]"></div>
                        </div>

                        <div class="lg:col-span-2 bg-white border-[3px] border-black p-6 bauhaus-shadow">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold border-l-4 border-black pl-3">SP å›é¥‹åŸå§‹æ•¸æ“š</h3>
                                <button onclick="exportSpCSV()" class="text-xs font-bold underline hover:text-[#1C4E8C] flex items-center gap-1">
                                    <i data-lucide="download" class="w-3 h-3"></i> åŒ¯å‡º CSV
                                </button>
                            </div>
                            <div class="overflow-x-auto max-h-[400px] custom-scroll">
                                <table class="w-full text-left text-sm border-collapse">
                                    <thead class="bg-black text-white sticky top-0 z-10">
                                        <tr>
                                            <th class="p-3 whitespace-nowrap">æ—¥æœŸ</th><th class="p-3 whitespace-nowrap">SPå§“å</th><th class="p-3 text-center">ç«™è™Ÿ</th>
                                            <th class="p-3 text-center">Q1</th><th class="p-3 text-center">Q2</th><th class="p-3 text-center">Q3</th>
                                            <th class="p-3 text-center">Q4</th><th class="p-3 text-center">Q4å¯¦éš›</th><th class="p-3 text-center">Q4å»ºè­°</th>
                                            <th class="p-3 text-center">Q5</th><th class="p-3 text-center">Q6</th>
                                            <th class="p-3 min-w-[200px]">å»ºè­°äº‹é … (Q7)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="sp-data-table-body">
                                        <tr><td colspan="12" class="p-8 text-center text-gray-400">Waiting for data...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <!-- Application Logic (Modularized & Bundled) -->
    <script type="module" src="js/app.min.js"></script>
</body>
</html>
